<!--
 ************************************************************************************
 * Copyright (C) 2008-2012 Openbravo S.L.U.
 * Licensed under the Apache Software License version 2.0
 * You may obtain a copy of the License at http://www.apache.org/licenses/LICENSE-2.0
 * Unless required by applicable law or agreed to  in writing,  software  distributed
 * under the License is distributed  on  an  "AS IS"  BASIS,  WITHOUT  WARRANTIES  OR
 * CONDITIONS OF ANY KIND, either  express  or  implied.  See  the  License  for  the
 * specific language governing permissions and limitations under the License.
 ************************************************************************************
-->
<html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<title>Response</title>
<link rel="shortcut icon" href="../../../../../web/images/favicon.ico" type="image/x-icon" />
<script language="JavaScript" src="../../../../../web/js/utils.js" type="text/javascript"></script>
<script language="JavaScript" src="../../../../../web/js/messages.js" type="text/javascript"></script>
<script language="JavaScript" type="text/javascript" id="paramLanguage">    defaultLang = "en_US";</script>
<script language="JavaScript" type="text/javascript">

function onLoadDo() {
  moreOnLoadDoFunctions();
  if (isIE9Strict) {
    var i=0;
    var setOpenerInterval = setInterval(
      function() {
        if (window.opener || i === 20) {
          clearInterval(setOpenerInterval);
          closeThisPage();
        } else {
          i++;
        }
      }, 20);
  } else {
    closeThisPage();
  }
}

function closeThisPage() {
  if (top && opener && opener.document && opener.document.getElementById('buttonRefresh')) {
    opener.document.getElementById('buttonRefresh').onclick();
  } else {
    var process;
    if (getFrame('LayoutMDI')) {
      process = getFrame('LayoutMDI').OB.ActionButton.executingProcess;
    } else if (top && top.opener) {
      process = top.opener.OB.ActionButton.executingProcess;
    }
     
    if (process) {
      // 3.0 window process
      process.closeProcessPopup();
    } else if (getFrame('LayoutMDI') && getFrame('LayoutMDI').OB.MainView.TabSet.getSelectedTab().pane.getAppFrameWindow 
               && getFrame('LayoutMDI').OB.MainView.TabSet.getSelectedTab().pane.getAppFrameWindow() 
               && getFrame('LayoutMDI').OB.MainView.TabSet.getSelectedTab().pane.getAppFrameWindow().submitCommandForm) {
      // 2.50 modal popup process
      getFrame('LayoutMDI').OB.MainView.TabSet.getSelectedTab().pane.getAppFrameWindow().submitCommandForm("DEFAULT", false, null, null, '_self');
    }
  }
  
  closePage();
  return true;
}
</script>
</head>
<body leftmargin="0" topmargin="0" marginwidth="0" marginheight="0"  onload="onLoadDo()">
</body>
</html>
