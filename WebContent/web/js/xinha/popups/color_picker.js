function colorPicker(d){var g=this;this.callback=d.callback?d.callback:function(l){alert("You picked "+l);};this.cellsize=d.cellsize?d.cellsize:"10px";this.side=d.granularity?d.granularity:18;this.value=1;this.saved_cells=null;this.table=document.createElement("table");this.table.cellSpacing=this.table.cellPadding=0;
this.tbody=document.createElement("tbody");this.table.appendChild(this.tbody);this.table.style.border="1px solid WindowFrame";this.table.style.backgroundColor="Window";var j=document.createElement("tr");var c=document.createElement("td");var h=document.createElement("button");h.onclick=function(){g.close();
};h.appendChild(document.createTextNode("x"));c.appendChild(h);c.style.position="relative";c.style.verticalAlign="middle";h.style.cssFloat="right";h.style.styleFloat="right";c.colSpan=this.side+3;c.style.backgroundColor="ActiveCaption";c.style.color="CaptionText";c.style.fontFamily="small-caption,caption,sans-serif";
c.style.fontSize="x-small";c.appendChild(document.createTextNode("Click a color..."));c.style.borderBottom="1px solid WindowFrame";j.appendChild(c);this.tbody.appendChild(j);h=j=c=null;this.constrain_cb=document.createElement("input");this.constrain_cb.type="checkbox";this.chosenColor=document.createElement("input");
this.chosenColor.type="text";this.chosenColor.size="7";this.backSample=document.createElement("div");this.backSample.appendChild(document.createTextNode("\u00A0"));this.backSample.style.fontWeight="bold";this.backSample.style.fontFamily="small-caption,caption,sans-serif";this.backSample.fontSize="x-small";
this.foreSample=document.createElement("div");this.foreSample.appendChild(document.createTextNode("Sample"));this.foreSample.style.fontWeight="bold";this.foreSample.style.fontFamily="small-caption,caption,sans-serif";this.foreSample.fontSize="x-small";function b(m){var l=m.toString(16);if(l.length<2){l="0"+l;
}return l;}function f(l){return"#"+b(l.red)+b(l.green)+b(l.blue);}function a(l,m){return Math.round(Math.round(l/m)*m);}function i(l){return parseInt(l.toString(16)+l.toString(16),16);}function e(l){l.red=i(a(parseInt(b(l.red).charAt(0),16),3));l.blue=i(a(parseInt(b(l.blue).charAt(0),16),3));l.green=i(a(parseInt(b(l.green).charAt(0),16),3));
return l;}function k(r,y,w){var l;if(y==0){l={red:w,green:w,blue:w};}else{r/=60;var o=Math.floor(r);var u=r-o;var n=w*(1-y);var m=w*(1-y*u);var x=w*(1-y*(1-u));switch(o){case 0:l={red:w,green:x,blue:n};break;case 1:l={red:m,green:w,blue:n};break;case 2:l={red:n,green:w,blue:x};break;case 3:l={red:n,green:m,blue:w};
break;case 4:l={red:x,green:n,blue:w};break;case 5:default:l={red:w,green:n,blue:m};break;}}l.red=Math.ceil(l.red*255);l.green=Math.ceil(l.green*255);l.blue=Math.ceil(l.blue*255);return l;}this.open=function(r,m){this.table.style.display="";this.pick_color();this.table.style.position="absolute";var p=m;
var o=0;var n=0;do{o+=p.offsetTop;n+=p.offsetLeft;p=p.offsetParent;}while(p);var l,q;if(/top/.test(r)){this.table.style.top=(o-this.table.offsetHeight)+"px";}else{this.table.style.top=(o+m.offsetHeight)+"px";}if(/left/.test(r)){this.table.style.left=n+"px";}else{this.table.style.left=(n-(this.table.offsetWidth-m.offsetWidth))+"px";
}};this.pick_color=function(){var v,w;var u=this;var B=359/this.side;var p=1/this.side;var t=1/this.side;var A=this.constrain_cb.checked;if(this.saved_cells==null){this.saved_cells=new Array();for(var q=0;q<=this.side;q++){var m=document.createElement("tr");this.saved_cells[q]=new Array();for(var n=0;
n<=this.side;n++){var r=document.createElement("td");if(A){r.colorCode=f(e(k(B*q,p*n,this.value)));}else{r.colorCode=f(k(B*q,p*n,this.value));}this.saved_cells[q][n]=r;r.style.height=r.style.width=this.cellsize;r.style.backgroundColor=r.colorCode;r.hue=B*q;r.saturation=p*n;r.onmouseover=function(){u.chosenColor.value=this.colorCode;
u.backSample.style.backgroundColor=this.colorCode;u.foreSample.style.color=this.colorCode;if((this.hue>=195&&this.saturation>0.25)||u.value<0.75){u.backSample.style.color="white";}else{u.backSample.style.color="black";}};r.onclick=function(){u.callback(this.colorCode);u.close();};r.appendChild(document.createTextNode(" "));
r.style.cursor="pointer";m.appendChild(r);r=null;}var r=document.createElement("td");r.appendChild(document.createTextNode(" "));r.style.width=this.cellsize;m.appendChild(r);r=null;var r=document.createElement("td");r.appendChild(document.createTextNode(" "));r.style.width=this.cellsize;r.style.height=this.cellsize;
r.constrainedColorCode=f(e(k(0,0,t*q)));r.style.backgroundColor=r.colorCode=f(k(0,0,t*q));r.hue=B*q;r.saturation=p*n;r.hsv_value=t*q;r.onclick=function(){u.value=this.hsv_value;u.pick_color();if(u.constrain_cb.checked){u.chosenColor.value=this.constrainedColorCode;}else{u.chosenColor.value=this.colorCode;
}};r.style.cursor="pointer";m.appendChild(r);r=null;this.tbody.appendChild(m);m=null;}var m=document.createElement("tr");this.saved_cells[q]=new Array();for(var n=0;n<=this.side;n++){var r=document.createElement("td");if(A){r.colorCode=f(e(k(0,0,t*(this.side-n))));}else{r.colorCode=f(k(0,0,t*(this.side-n)));
}this.saved_cells[q][n]=r;r.style.height=r.style.width=this.cellsize;r.style.backgroundColor=r.colorCode;r.hue=0;r.saturation=0;r.onmouseover=function(){u.chosenColor.value=this.colorCode;u.backSample.style.backgroundColor=this.colorCode;u.foreSample.style.color=this.colorCode;if((this.hue>=195&&this.saturation>0.25)||u.value<0.75){u.backSample.style.color="white";
}else{u.backSample.style.color="black";}};r.onclick=function(){u.callback(this.colorCode);u.close();};r.appendChild(document.createTextNode(" "));r.style.cursor="pointer";m.appendChild(r);r=null;}this.tbody.appendChild(m);m=null;var m=document.createElement("tr");var r=document.createElement("td");m.appendChild(r);
r.colSpan=this.side+3;r.style.padding="3px";var x=document.createElement("div");var s=document.createElement("label");s.appendChild(document.createTextNode("Web Safe: "));this.constrain_cb.onclick=function(){u.pick_color();};s.appendChild(this.constrain_cb);s.style.fontFamily="small-caption,caption,sans-serif";
s.style.fontSize="x-small";x.appendChild(s);r.appendChild(x);var x=document.createElement("div");var s=document.createElement("label");s.style.fontFamily="small-caption,caption,sans-serif";s.style.fontSize="x-small";s.appendChild(document.createTextNode("Color: "));s.appendChild(this.chosenColor);x.appendChild(s);
r.appendChild(x);var l=document.createElement("table");l.style.width="100%";var z=document.createElement("tbody");l.appendChild(z);var o=document.createElement("tr");z.appendChild(o);var y=document.createElement("td");o.appendChild(y);y.appendChild(this.backSample);y.style.width="50%";var C=document.createElement("td");
o.appendChild(C);C.appendChild(this.foreSample);C.style.width="50%";r.appendChild(l);this.tbody.appendChild(m);document.body.appendChild(this.table);}else{for(var q=0;q<=this.side;q++){for(var n=0;n<=this.side;n++){if(A){this.saved_cells[q][n].colorCode=f(e(k(B*q,p*n,this.value)));}else{this.saved_cells[q][n].colorCode=f(k(B*q,p*n,this.value));
}this.saved_cells[q][n].style.backgroundColor=this.saved_cells[q][n].colorCode;}}}};this.close=function(){this.table.style.display="none";};}