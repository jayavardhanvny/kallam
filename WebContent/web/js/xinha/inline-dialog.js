HTMLArea.Dialog=function(d,c,a){this.id={};this.r_id={};this.editor=d;this.document=document;this.rootElem=document.createElement("div");this.rootElem.className="dialog";this.rootElem.style.position="absolute";this.rootElem.style.display="none";this.editor._framework.ed_cell.insertBefore(this.rootElem,this.editor._framework.ed_cell.firstChild);
this.rootElem.style.width=this.width=this.editor._framework.ed_cell.offsetWidth+"px";this.rootElem.style.height=this.height=this.editor._framework.ed_cell.offsetHeight+"px";var b=this;if(typeof a=="function"){this._lc=a;}else{if(a){this._lc=function(e){return HTMLArea._lc(e,a);};}else{this._lc=function(e){return e;
};}}c=c.replace(/\[([a-z0-9_]+)\]/ig,function(e,f){if(typeof b.id[f]=="undefined"){b.id[f]=HTMLArea.uniq("Dialog");b.r_id[b.id[f]]=f;}return b.id[f];}).replace(/<l10n>(.*?)<\/l10n>/ig,function(e,f){return b._lc(f);}).replace(/="_\((.*?)\)"/g,function(e,f){return'="'+b._lc(f)+'"';});this.rootElem.innerHTML=c;
this.editor.notifyOn("resize",function(g,f){b.rootElem.style.width=b.width=b.editor._framework.ed_cell.offsetWidth+"px";b.rootElem.style.height=b.height=b.editor._framework.ed_cell.offsetHeight+"px";b.onresize();});};HTMLArea.Dialog.prototype.onresize=function(){return true;};HTMLArea.Dialog.prototype.show=function(a){if(HTMLArea.is_ie){this._lastRange=this.editor._createRange(this.editor._getSelection());
}if(typeof a!="undefined"){this.setValues(a);}this._restoreTo=[this.editor._textArea.style.display,this.editor._iframe.style.visibility,this.editor.hidePanels()];this.editor._textArea.style.display="none";this.editor._iframe.style.visibility="hidden";this.rootElem.style.display="";};HTMLArea.Dialog.prototype.hide=function(){this.rootElem.style.display="none";
this.editor._textArea.style.display=this._restoreTo[0];this.editor._iframe.style.visibility=this._restoreTo[1];this.editor.showPanels(this._restoreTo[2]);if(HTMLArea.is_ie){this._lastRange.select();}this.editor.updateToolbar();return this.getValues();};HTMLArea.Dialog.prototype.toggle=function(){if(this.rootElem.style.display=="none"){this.show();
}else{this.hide();}};HTMLArea.Dialog.prototype.setValues=function(d){for(var g in d){var c=this.getElementsByName(g);if(!c){continue;}for(var a=0;a<c.length;a++){var h=c[a];switch(h.tagName.toLowerCase()){case"select":for(var f=0;f<h.options.length;f++){if(typeof d[g]=="object"){for(var b=0;b<d[g].length;
b++){if(d[g][b]==h.options[f].value){h.options[f].selected=true;}}}else{if(d[g]==h.options[f].value){h.options[f].selected=true;}}}break;case"textarea":case"input":switch(h.getAttribute("type")){case"radio":if(h.value==d[g]){h.checked=true;}break;case"checkbox":if(typeof d[g]=="object"){for(var f in d[g]){if(d[g][f]==h.value){h.checked=true;
}}}else{if(d[g]==h.value){h.checked=true;}}break;default:h.value=d[g];}break;default:break;}}}};HTMLArea.Dialog.prototype.getValues=function(){var d=[];var b=HTMLArea.collectionToArray(this.rootElem.getElementsByTagName("input")).append(HTMLArea.collectionToArray(this.rootElem.getElementsByTagName("textarea"))).append(HTMLArea.collectionToArray(this.rootElem.getElementsByTagName("select")));
for(var a=0;a<b.length;a++){var f=b[a];if(!(f.name&&this.r_id[f.name])){continue;}if(typeof d[this.r_id[f.name]]=="undefined"){d[this.r_id[f.name]]=null;}var c=d[this.r_id[f.name]];switch(f.tagName.toLowerCase()){case"select":if(f.multiple){if(!c.push){if(c!=null){c=[c];}else{c=new Array();}}for(var e=0;
e<f.options.length;e++){if(f.options[e].selected){c.push(f.options[e].value);}}}else{if(f.selectedIndex>=0){c=f.options[f.selectedIndex];}}break;case"textarea":case"input":default:switch(f.type.toLowerCase()){case"radio":if(f.checked){c=f.value;break;}case"checkbox":if(c==null){if(this.getElementsByName(this.r_id[f.name]).length>1){c=new Array();
}}if(f.checked){if(c!=null&&typeof c=="object"&&c.push){c.push(f.value);}else{c=f.value;}}break;default:c=f.value;break;}}d[this.r_id[f.name]]=c;}return d;};HTMLArea.Dialog.prototype.getElementById=function(a){return this.document.getElementById(this.id[a]?this.id[a]:a);};HTMLArea.Dialog.prototype.getElementsByName=function(a){return this.document.getElementsByName(this.id[a]?this.id[a]:a);
};