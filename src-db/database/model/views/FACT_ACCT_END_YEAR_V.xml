<?xml version="1.0"?>
  <database name="VIEW FACT_ACCT_END_YEAR_V">
    <view name="FACT_ACCT_END_YEAR_V"><![CDATA[SELECT max(fact_acct.fact_acct_id) AS fact_acct_end_year_v_id, fact_acct.ad_client_id, a.ad_org_id, max(fact_acct.created) AS created, max(fact_acct.createdby) AS createdby, max(fact_acct.updated) AS updated, max(fact_acct.updatedby) AS updatedby, max(fact_acct.isactive) AS isactive, a.c_periodcontrol_id AS c_year_close_v_id, max(fact_acct.fact_acct_id) AS fact_acct_id, fact_acct.c_acctschema_id, fact_acct.account_id, fact_acct.factaccttype, CASE WHEN sum(fact_acct.amtacctdr - fact_acct.amtacctcr) > 0 THEN sum(fact_acct.amtacctdr - fact_acct.amtacctcr) ELSE 0 END AS debit, CASE WHEN sum(fact_acct.amtacctcr - fact_acct.amtacctdr) > 0 THEN sum(fact_acct.amtacctcr - fact_acct.amtacctdr) ELSE 0 END AS credit FROM fact_acct, c_period, (SELECT max(pc.c_periodcontrol_id) AS c_periodcontrol_id, p.c_year_id, pc.ad_org_id FROM c_periodcontrol pc, c_period p WHERE pc.c_period_id = p.c_period_id GROUP BY p.c_year_id, pc.ad_org_id) a WHERE fact_acct.c_period_id = c_period.c_period_id AND (fact_acct.factaccttype IN ('O', 'C', 'D', 'R')) AND a.c_year_id = c_period.c_year_id AND a.ad_org_id = ad_org_getperiodcontrolallow(fact_acct.ad_org_id) GROUP BY fact_acct.ad_client_id, a.ad_org_id, a.c_periodcontrol_id, fact_acct.c_acctschema_id, fact_acct.account_id, fact_acct.factaccttype HAVING sum(fact_acct.amtacctcr - fact_acct.amtacctdr) <> 0]]></view>
  </database>
